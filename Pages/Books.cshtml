@page
@model BiblioTech.Pages.BooksModel
@{
}
<div class="search-body">
    <div class="d-flex mb-5 justify-content-md-start align-items-center">
        <h1 class="display-4 mt-5 w-50 ms-4 search-text">Rechercher Des Livres En ligne</h1>
    </div>
    <script>
        function scan()
        {
            let BarcodeDetector = window['BarcodeDetector'];
            console.log(BarcodeDetector);
            const barcodeDetector = new BarcodeDetector({
                formats: ["code_39", "codabar", "ean_13", "upc_a"],
            });
            barcodeDetector
                .detect(imageEl)
                .then((barcodes) => {
                    barcodes.forEach((barcode) => console.log(barcode.rawValue));
                })
                .catch((err) => {
                    console.log(err);
                });
        }
    </script>
    <div>
        <form class="d-flex  justify-content-md-center align-items-center flex-column search-form-mobile">
            <input class="form-control w-75 me-sm-2" name="q" type="search" placeholder="Search">
            <button class="btn btn-primary w-75 my-2 my-sm-0" type="submit">Search</button>
        </form>
    </div>
</div>
@if (Model.livres != null)
{
    @if (Model.livres.Count == 0)
    {
        <div class="search-result w-100 d-flex text-danger justify-content-md-center align-items-center"><i class="fa-solid fa-circle-exclamation"></i><span>
                aucun résultat trouvé
            </span>
        </div>
    }
    else
    {
        <div class="search-result w-100 d-flex justify-content-md-center align-items-center flex-column ">
            <div class="grid-container">
            @foreach (Book b in Model.livres)
            {
                <div class="card mb-5" >
                        <img class="card-img-top" src="@(b.img==null?"/css/Defaultbook.jpg":b.img)" alt="Card image cap">
                    <div class="card-body">
                        <h5 class="card-title">Titre : @b.titre</h5>
                        @if (b.descr != null)
                        {
                            @if(b.descr.Length > 100)
                            {
                                <li class="list-group-item">@b.descr.Substring(0,100)...</li>
                            }
                            else{
                                <li class="list-group-item">@b.descr</li>
                            }
                        }
                    </div>
                    <ul class="list-group list-group-flush">
                        @if (b.aut != null)
                        {
                            <li class="list-group-item">Auteur : @b.aut</li>
                        }
                        @if (b.annee != null)
                        {
                            <li class="list-group-item">Anneee : @b.annee</li>
                        }
                        @if (b.cat != null)
                        {
                            <li class="list-group-item">Categorie : @b.cat</li>
                        }
                        @if (b.edit != null)
                        {
                            <li class="list-group-item">Editeur : @b.edit</li>
                        }
                    </ul>
                        <a href="@b.url" target="_blank" class="d-flex justify-content-center w-100"><button type="button" class="btn btn-success w-100">Ouvrir</button></a>
                        @if (b.preview != null)
                        {
                            <a href="@b.preview" target="_blank" class="d-flex justify-content-center w-100"><button type="button" class="btn btn-info w-100"><i class="fa-solid fa-eye"></i>Preveiw</button></a>
                        }
                        @if (b.downloadlink != null)
                        {
                            <a href="@b.downloadlink" target="_blank" class="d-flex justify-content-center w-100"><button type="button" class="btn btn-danger w-100"><i class="fa-solid fa-arrow-down"></i>Download</button></a>
                        }

                </div>
            }
            </div>
        </div>
    }
}